module.exports=function(t){var e={};function s(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=6)}([function(t,e){t.exports=require("scenegraph")},function(t,e){t.exports=require("application")},function(t,e){t.exports=require("uxp")},function(t,e){t.exports=require("viewport")},function(t,e){t.exports=require("commands")},function(t,e){t.exports=require("assets")},function(t,e,s){t.exports=s(8)},function(t,e){t.exports={install:function(t,e,s){s.add("get",function(e,s,r){try{t.color;var n=t.quoted,a=t.functions.functionRegistry.get("color");t.functions.functionRegistry.get("escape");let o=new RegExp("\\[CONTROLLER:(.*)\\]","g").exec(e.value);if(o){let t=XDC.root,e=o[1];for(let o=0,i=t.children.length;o<i;o++){let i=t.children.at(o);if(i.name==`[CONTROLLER:${e}]`)for(let t=0,e=i.children.length;t<e;t++){let e=i.children.at(t);if(-1!=e.name.indexOf(s.value))switch(console.log("node",e.name),r.value){case"fill":return a(n('"',e.fill.toHex()));case"stroke-width":return console.log("node.strokeWidth",e.strokeWidth),e.strokeWidth;case"stroke-color":return a(n('"',e.stroke.toHex()));case"corner-radius":return e.cornerRadii.topLeft;case"font-family":return e.fontFamily}}}}}catch(t){console.log("ERROR IN CUSTOM FUNC: ",t)}})}}},function(t,e,s){"use strict";s.r(e);const r=s(0),{selection:n,root:a}=s(0),o=s(4),i=s(1),l=s(2).storage,c=s(3),d=s(2).storage.localFileSystem;const p=s(5),h=s(7);const u=!1,g="[ WebExport:WebGraphCreator ]";class y{constructor(t,e){this.entry=t,this.isSupported=!1,this.type=t.type,this.node=t.node,this.ignoreChildren=!1,this.expressions=t.expressions,this.classes=t.classes||[],this.index=e,this.id,this.xdid=t.node.guid,this.data,this.closingTag,this.inner="",this.styles={},this.attributes={},this.children=[],this.renditions,this.warnings=[];const s=t.node,r=s.transform,n=r.clone();n.rotate(-r.getRotation(),s.localCenterPoint.x,s.localCenterPoint.y);const a=n.e,o=n.f,i=new XDC.scenegraph.Matrix;i.translate(-(r.e-a),-(r.f-o));const l=i.add(r);this.translationX=l.e,this.translationY=l.f,this.process(t),this.addWarnings()}process(t){let e;if(this.id=XDC.core.getId(this.node),this.data=XDC.core.getData(this.node,"data")||{},this.data&&this.data.exportAs&&this.data.exportAs.match(/jpg|png|svg/)&&(e=O),e)e.apply(this,this.node),this.isSupported=!0;else{const t=[f,m,x,k,w,A,C,E,S,R,b,$];for(var s=0;s<t.length;s++){let e=t[s];if(e.check(this,this.node)){e.apply(this,this.node),this.isSupported=!0;break}}}}applyAttributes(){let t="";t+=this.classes.length?`class="${this.classes.map(t=>t.replace(".","")).join(" ")}" `:"";let e=XDC.core.getData(this.node,"attributes");if(e){u&&console.log(g,"custom attribute(s) found:",e);for(const t in e)this.attributes[t]=e[t]}for(var s in this.attributes)t+=this.attributes[s]?`${s}="${this.attributes[s]}" `:`${s} `;this.tagOpen=this.tagOpen.replace("#!ATTRIBUTES#",t)}addWarnings(){-1!=["Path","Line","Text","Group"].indexOf(this.type)&&0!=this.node.rotation&&this.warnings.push({code:"UNSUPPORTED_ROTATION",entry:this})}}class f{static check(t,e){return"Artboard"==t.type}static apply(t,e){t.classes.push("artboard"),t.tagOpen=`<div ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.styles.position="relative",D.applySize(t,e),D.getFill(e).value&&(t.styles["background-color"]=D.getFill(e).value)}}class m{static check(t,e){return"Group"==t.type&&e.mask}static apply(t,e){A.apply(t,e),t.styles.width=`${e.boundsInParent.width}px`,t.styles.height=`${e.boundsInParent.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class x{static check(t,e){return"BooleanGroup"==t.type}static apply(t,e){A.apply(t,e),t.styles.width=`${e.localBounds.width}px`,t.styles.height=`${e.localBounds.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class b{static check(t,e){return"Polygon"==t.type}static apply(t,e){A.apply(t,e),t.styles.width=`${e.width}px`,t.styles.height=`${e.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class ${static check(t,e){return"RepeatGrid"==t.type}static apply(t,e){k.apply(t,e),t.attributes["xd-repeat-grid"]=encodeURIComponent(JSON.stringify({width:e.width,height:e.height,cellWidth:e.cellSize.width,cellHeight:e.cellSize.height,numRows:e.numRows,numColumns:e.numColumns,paddingX:e.paddingX,paddingY:e.paddingY,offsetX:e.children.at(0).localBounds.x,offsetY:e.children.at(0).localBounds.y}))}}class k{static check(t,e){return"Group"==t.type||"SymbolInstance"==t.type}static apply(t,e){t.tagOpen=`<div ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",D.applyTransformation(t,e),D.applyOpacity(t,e)}}class w{static check(t,e){return"Text"==t.type}static apply(t,e){{t.tagOpen=`<div ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.inner=e.text.replace(/\n/g,"<br/>"),e.areaBox?(t.styles.width=D.num(e.areaBox.width)+"px",t.styles.height=D.num(e.areaBox.height)+"px"):t.styles.width=D.num(e.boundsInParent.width+20)+"px",t.styles["font-family"]=`${e.fontFamily}`,-1!=e.fontStyle.toLowerCase().indexOf("italic")&&(t.styles["font-style"]="italic"),t.styles["font-size"]=`${e.fontSize}px`,t.styles.color=D.getFill(e).value,"left"!=e.textAlign&&(t.styles["text-align"]=e.textAlign);const s=e.fontStyle.toLowerCase(),r=s.match(/extra-light|extralight|ultra-light|ultralight/)?"200":s.match(/light/)?"300":s.match(/semi-bold|semibold|demi-bold|demibold/)?"600":s.match(/extra-bold|extrabold|ultra-bold|ultrabold/)?"800":s.match(/bold/)?"700":s.match(/thin/)?"100":s.match(/medium/)?"500":s.match(/black|heavy/)?"900":400;if(t.styles["font-weight"]=r,0==e.rotation&&(t.styles.top=D.num(e.boundsInParent.y)+"px",t.styles.left=D.num(e.boundsInParent.x)+"px"),D.applyOpacity(t,e),e.lineSpacing){t.styles["line-height"]=e.lineSpacing+"px";const s=e.fontSize>20?5:1;t.styles.top=e.boundsInParent.y-(e.lineSpacing-e.fontSize)/2+s+"px"}}}}class C{static check(t,e){return-1!=["Line"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<svg ${D.getDefaultAttributes(t)} xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1" height="1" #!ATTRIBUTES#>`,t.tagClose="</svg>";let s=e.strokeEnabled?`stroke="${D.getStroke(e).value}"`:"",r="butt"!=e.strokeEndCaps?` stroke-linecap="${e.strokeEndCaps}"`:"",n=e.strokeDashArray.length?` stroke-dasharray="${e.strokeDashArray.join(" ")}"`:"";t.inner=`<line id="${t.id}-line"\n                              x1="${e.start.x}" y1="${e.start.y}" x2="${e.end.x}" y2="${e.end.y}"\n                              ${s}\n                              stroke-width="${e.strokeWidth}"\n                              ${r} ${n}\n                              />`,t.styles.overflow="visible",D.applyTransformation(t,e),D.applyOpacity(t,e)}}class E{static check(t,e){return-1!=["Rectangle"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",D.applySize(t,e),D.applyTransformation(t,e),D.applyOpacity(t,e);const s=D.getFill(e);"Color"==s.type?t.styles["background-color"]=s.value:"LinearGradientFill"==s.type&&(t.styles.background=s.value),D.getStroke(e).value&&(t.styles.border=`${e.strokeWidth}px solid ${D.getStroke(e).value}`),e.hasRoundedCorners&&(t.styles["border-radius"]=`${e.cornerRadii.topLeft}px ${e.cornerRadii.topRight}px ${e.cornerRadii.bottomRight}px ${e.cornerRadii.bottomLeft}px`)}}class S{static check(t,e){return-1!=["Ellipse"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.styles.width=D.num(2*e.radiusX)+"px",t.styles.height=D.num(2*e.radiusY)+"px",t.styles["border-radius"]="50% 50%",D.applyTransformation(t,e),D.applyOpacity(t,e);const s=D.getFill(e);"Color"==s.type?t.styles["background-color"]=s.value:"LinearGradientFill"==s.type&&(t.styles.background=s.value),D.getStroke(e).value&&(t.styles.border=`${e.strokeWidth}px solid ${D.getStroke(e).value}`)}}class R{static check(t,e){return-1!=["Path"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<svg ${D.getDefaultAttributes(t)} width="1" height="1" #!ATTRIBUTES#>`,t.tagClose="</svg>";let s=e.fillEnabled&&D.getFill(e).value?`fill="${D.getFill(e).value}"`:'fill="transparent"',r=e.strokeEnabled&&D.getStroke(e).value?`stroke="${D.getStroke(e).value}"`:"",n=e.pathData.replace(/(\d+\.\d+)/g,(t,e,s,r)=>parseFloat(e).toFixed(3));t.inner=`<path id="${t.id}-path" d="${n}"\n                           ${s} ${r} stroke-width="${e.strokeWidth}"\n                            />`,t.styles.overflow="visible",D.applyTransformation(t,e),D.applyOpacity(t,e)}}class A{static check(t,e){const s=D.getFill(e);if(s&&-1!=["ImageFill"].indexOf(s.type))return!0}static apply(t,e){const s=e.fill&&e.fill.mimeType&&-1==e.fill.mimeType.indexOf("png")?"jpg":"png";O.apply(t,e,s)}}class O{static apply(t,e,s){t.ignoreChildren=!0,t.type,t.styles.width=D.num(e.localBounds.width)+"px",t.styles.height=D.num(e.localBounds.height)+"px",t.styles.transform=`translate(${e.boundsInParent.x}px, ${e.boundsInParent.y}px)`,t.translationX=e.boundsInParent.x,t.translationY=e.boundsInParent.y,t.type="Image",t.tagOpen=`<img ${D.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="";let r=s||t.data.exportAs,n=t.data.exportScale?Number(t.data.exportScale):void 0;t.renditions=[],t.renditions.push({id:t.id,element:t,node:e,type:r,scale:n}),t.attributes.src=`${t.id}.${r}`,D.applyOpacity(t,e)}}class D{static num(t,e=3){const s=Math.pow(10,e);return Math.round(t*s)/s}static getDefaultAttributes(t){return`id="${t.id}"`}static applySize(t,e){e.width&&(t.styles.width=D.num(e.width)+"px"),e.height&&(t.styles.height=D.num(e.height)+"px")}static applyTransformation(t,e){const s=e.transform;if(0==e.rotation)t.styles.transform=`translate(${Math.round(1e3*s.e)/1e3}px, ${Math.round(1e3*s.f)/1e3}px)`;else{t.styles["transform-origin"]="50% 50%";const r=s.clone();r.rotate(-s.getRotation(),e.localCenterPoint.x,e.localCenterPoint.y);const n=r.e,a=r.f,o=new XDC.scenegraph.Matrix;o.translate(-(s.e-n),-(s.f-a));const i=o.add(s);t.styles.transform=`matrix(${i.a}, ${i.b}, ${i.c}, ${i.d}, ${i.e}, ${i.f})`}}static getFill(t){if(!t.fillEnabled||!t.fill)return!1;let e,s=t.fill.constructor.name;if("Color"==s)e=t.fill.a<255?`rgba(${t.fill.r}, ${t.fill.g}, ${t.fill.b}, ${Math.round(t.fill.a/255*100)/100})`:t.fill.toHex();else if("LinearGradientFill"==s){let s=t.fill.endX-t.fill.startX,r=t.fill.endY-t.fill.startY,n=Math.atan(r/s),a=180/Math.PI*n;a+=90;let o="";t.fill.colorStops.forEach(t=>{o+=`, ${t.color.toHex()} ${100*t.stop}%`}),e=`linear-gradient(${a}deg${o})`}return{type:s,value:e}}static getStroke(t){if(!t.strokeEnabled||!t.stroke)return!1;return{type:t.stroke.constructor.name,value:t.stroke.a<255?`rgba(${t.stroke.r}, ${t.stroke.g}, ${t.stroke.b}, ${Math.round(t.stroke.a/255*100)/100})`:t.stroke.toHex()}}static applyOpacity(t,e){e.opacity<1&&(t.styles.opacity=e.opacity)}}const T=!1,I="[ WebGraphCreatorNext ]";class P{constructor(t,e){this.entry=t,this.isSupported=!1,this.type=t.type,this.node=t.node,this.ignoreChildren=!1,this.expressions=t.expressions,this.classes=t.classes||[],this.index=e,this.id,this.xdid=t.node.guid,this.data,this.closingTag,this.inner="",this.styles={},this.attributes={},this.children=[],this.renditions,this.warnings=[],this.process(t),this.addWarnings()}process(t){let e;if(this.id=XDC.core.getId(this.node),this.data=XDC.core.getData(this.node,"data")||{},this.data&&this.data.exportAs&&this.data.exportAs.match(/jpg|png|svg/)&&(e=j),e)e.apply(this,this.node),this.isSupported=!0;else{const t=[_,B,X,L,G,U,M,W,Y,z,N,F];for(var s=0;s<t.length;s++){let e=t[s];if(e.check(this,this.node)){e.apply(this,this.node),this.isSupported=!0;break}}}}applyAttributes(){let t="";t+=this.classes.length?`class="${this.classes.map(t=>t.replace(".","")).join(" ")}" `:"";let e=XDC.core.getData(this.node,"attributes");if(e){T&&console.log(I,"custom attribute(s) found:",e);for(const t in e)this.attributes[t]=e[t]}for(var s in this.attributes)t+=this.attributes[s]?`${s}="${this.attributes[s]}" `:`${s} `;this.tagOpen=this.tagOpen.replace("#!ATTRIBUTES#",t)}addWarnings(){"Text"==this.type&&0!=this.node.rotation&&this.warnings.push({code:"UNSUPPORTED_ROTATION",entry:this})}}class _{static check(t,e){return"Artboard"==t.type}static apply(t,e){t.classes.push("artboard"),t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.styles.position="relative",H.applySize(t,e),H.getFill(e).value&&(t.styles["background-color"]=H.getFill(e).value)}}class B{static check(t,e){return"Group"==t.type&&e.mask}static apply(t,e){U.apply(t,e),t.styles.width=`${e.boundsInParent.width}px`,t.styles.height=`${e.boundsInParent.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class X{static check(t,e){return"BooleanGroup"==t.type}static apply(t,e){U.apply(t,e),t.styles.width=`${e.localBounds.width}px`,t.styles.height=`${e.localBounds.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class N{static check(t,e){return"Polygon"==t.type}static apply(t,e){U.apply(t,e),t.styles.width=`${e.width}px`,t.styles.height=`${e.height}px`,0==e.rotation&&(t.styles.transform=`translate(${Math.round(1e3*e.boundsInParent.x)/1e3}px, ${Math.round(1e3*e.boundsInParent.y)/1e3}px)`)}}class F{static check(t,e){return"RepeatGrid"==t.type}static apply(t,e){L.apply(t,e),t.attributes["xd-repeat-grid"]=encodeURIComponent(JSON.stringify({width:e.width,height:e.height,cellWidth:e.cellSize.width,cellHeight:e.cellSize.height,numRows:e.numRows,numColumns:e.numColumns,paddingX:e.paddingX,paddingY:e.paddingY,offsetX:e.children.at(0).localBounds.x,offsetY:e.children.at(0).localBounds.y}))}}class L{static check(t,e){return"Group"==t.type||"SymbolInstance"==t.type}static apply(t,e){let s=XDC.core.getData(e,"attributes");if(s&&s.hasOwnProperty("hero-fx-magnet"))return void U.apply(t,e);if(XDC.root.pluginData&&XDC.root.pluginData.mojo&&XDC.root.pluginData.mojo.graph){let s=JSON.parse(XDC.root.pluginData.mojo.graph);for(let r=0;r<s.scenes.length;r++){const n=s.scenes[r];for(let s=0;s<n.elements.length;s++){const r=n.elements[s];if(r.guid==e.guid)for(let s=0;s<r.tracks.length;s++){const n=r.tracks[s];if(["scale","rotation","scaleX","scaleY"].indexOf(n.property))return void U.apply(t,e)}}}}t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>";const r=e.transform.clone(),n=r.clone(),a=n.e,o=n.f,i=new XDC.scenegraph.Matrix;i.translate(-(r.e-a),-(r.f-o));let l=i.add(r);const c=new XDC.scenegraph.Matrix;l=c.add(l),t.styles["transform-origin"]="50% 50%",t.styles.transform=`matrix(${l.a}, ${l.b}, ${l.c}, ${l.d}, ${l.e}, ${l.f})`,t.translationX=c.e,t.translationY=c.f,H.applyOpacity(t,e)}}class G{static check(t,e){return"Text"==t.type}static apply(t,e){{t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.inner=e.text.replace(/\n/g,"<br/>"),e.areaBox?(t.styles.width=H.num(e.areaBox.width)+"px",t.styles.height=H.num(e.areaBox.height)+"px"):t.styles.width=H.num(e.boundsInParent.width+3)+"px",t.styles["font-family"]=`${e.fontFamily}`,-1!=e.fontStyle.toLowerCase().indexOf("italic")&&(t.styles["font-style"]="italic"),t.styles["font-size"]=`${e.fontSize}px`,t.styles.color=H.getFill(e).value,"left"!=e.textAlign&&(t.styles["text-align"]=e.textAlign);const s=e.fontStyle.toLowerCase(),r=s.match(/extra-light|extralight|ultra-light|ultralight/)?"200":s.match(/light/)?"300":s.match(/semi-bold|semibold|demi-bold|demibold/)?"600":s.match(/extra-bold|extrabold|ultra-bold|ultrabold/)?"800":s.match(/bold/)?"700":s.match(/thin/)?"100":s.match(/medium/)?"500":s.match(/black|heavy/)?"900":400;t.styles["font-weight"]=r,H.applyTransformationNext(t,e),H.applyOpacity(t,e)}}}class M{static check(t,e){return-1!=["Line"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>";let s=e.strokeEnabled?`stroke="${H.getStroke(e).value}"`:"",r="butt"!=e.strokeEndCaps?` stroke-linecap="${e.strokeEndCaps}"`:"",n=e.strokeDashArray.length?` stroke-dasharray="${e.strokeDashArray.join(" ")}"`:"";t.inner=`<line id="${t.id}-line"\n                              x1="${e.start.x}" y1="${e.start.y}" x2="${e.end.x}" y2="${e.end.y}"\n                              ${s}\n                              stroke-width="${e.strokeWidth}"\n                              ${r} ${n}\n                              />`,H.applyTransformationNext(t,e,!0),H.applyOpacity(t,e),t.inner=`\n      <svg width="1" height="1" style="overflow: visible; position: absolute; left: ${-1*e.localBounds.x}px; top: ${-1*e.localBounds.y}px;">\n        <line id="${t.id}-line"\n              x1="${e.start.x}" y1="${e.start.y}" x2="${e.end.x}" y2="${e.end.y}"\n              ${s}\n              stroke-width="${e.strokeWidth}"\n              ${r} ${n} />    \n      </svg>\n    `}}class W{static check(t,e){return-1!=["Rectangle"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",H.applySize(t,e),H.applyTransformationNext(t,e),H.applyOpacity(t,e);const s=H.getFill(e);"Color"==s.type?t.styles["background-color"]=s.value:"LinearGradientFill"==s.type&&(t.styles.background=s.value),H.getStroke(e).value&&(t.styles.border=`${e.strokeWidth}px solid ${H.getStroke(e).value}`),e.hasRoundedCorners&&(t.styles["border-radius"]=`${e.cornerRadii.topLeft}px ${e.cornerRadii.topRight}px ${e.cornerRadii.bottomRight}px ${e.cornerRadii.bottomLeft}px`)}}class Y{static check(t,e){return-1!=["Ellipse"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",t.styles.width=H.num(2*e.radiusX)+"px",t.styles.height=H.num(2*e.radiusY)+"px",t.styles["border-radius"]="50% 50%",H.applyTransformationNext(t,e),H.applyOpacity(t,e);const s=H.getFill(e);"Color"==s.type?t.styles["background-color"]=s.value:"LinearGradientFill"==s.type&&(t.styles.background=s.value),H.getStroke(e).value&&(t.styles.border=`${e.strokeWidth}px solid ${H.getStroke(e).value}`)}}class z{static check(t,e){return-1!=["Path"].indexOf(t.type)}static apply(t,e){t.tagOpen=`<div ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="</div>",H.applySize(t,e),H.applyTransformationNext(t,e),H.applyOpacity(t,e);let s=e.fillEnabled?`fill="${H.getFill(e).value}"`:'fill="none"',r=e.strokeEnabled&&H.getStroke(e).value?`stroke="${H.getStroke(e).value}"`:"",n=e.pathData.replace(/(\d+\.\d+)/g,(t,e,s,r)=>parseFloat(e).toFixed(3));t.inner=`\n      <svg width="1" height="1" style="overflow: visible; position: absolute; left: ${-1*e.localBounds.x}px; top: ${-1*e.localBounds.y}px;">\n        <path id="${t.id}-path" d="${n}" ${s} ${r} stroke-width="${e.strokeWidth}" />\n      </svg>\n    `}}class U{static check(t,e){const s=H.getFill(e);if(s&&-1!=["ImageFill"].indexOf(s.type))return!0}static apply(t,e){const s=e.fill&&e.fill.mimeType&&-1==e.fill.mimeType.indexOf("png")?"jpg":"png";j.apply(t,e,s)}}class j{static apply(t,e,s){if(t.ignoreChildren=!0,"Group"!=t.type)t.styles.width=H.num(e.localBounds.width)+"px",t.styles.height=H.num(e.localBounds.height)+"px";else if(0==e.rotation)t.styles.width=H.num(e.globalDrawBounds.width)+"px",t.styles.height=H.num(e.globalDrawBounds.height)+"px";else{const s=e.rotation;e.rotateAround(-s,e.localCenterPoint),t.styles.width=H.num(e.globalDrawBounds.width)+"px",t.styles.height=H.num(e.globalDrawBounds.height)+"px",e.rotateAround(s,e.localCenterPoint)}H.applyTransformationNext(t,e),t.type="Image",t.tagOpen=`<img ${H.getDefaultAttributes(t)} #!ATTRIBUTES#>`,t.tagClose="";let r=s||t.data.exportAs,n=t.data.exportScale?Number(t.data.exportScale):void 0;t.renditions=[],t.renditions.push({id:t.id,element:t,node:e,type:r,scale:n}),t.attributes.src=`${t.id}.${r}`,H.applyOpacity(t,e)}}class H{static num(t,e=3){const s=Math.pow(10,e);return Math.round(t*s)/s}static getDefaultAttributes(t){return`id="${t.id}"`}static applySize(t,e){t.styles.width=H.num(e.localBounds.width)+"px",t.styles.height=H.num(e.localBounds.height)+"px"}static applyTransformationNext(t,e,s){const r=e.transform.clone(),n=r.clone();n.rotate(-r.getRotation(),e.localCenterPoint.x,e.localCenterPoint.y);const a=n.e,o=n.f,i=new XDC.scenegraph.Matrix;!s&&i.translate(-(r.e-a),-(r.f-o));let l=i.add(r);const c=new XDC.scenegraph.Matrix;!s&&c.translate(e.localBounds.x,e.localBounds.y),l=c.add(l),t.styles["transform-origin"]="50% 50%",t.styles.transform=`matrix(${l.a}, ${l.b}, ${l.c}, ${l.d}, ${l.e}, ${l.f})`,t.translationX=c.e,t.translationY=c.f}static getFill(t){if(!t.fillEnabled||!t.fill)return!1;let e,s=t.fill.constructor.name;if("Color"==s)e=t.fill.a<255?`rgba(${t.fill.r}, ${t.fill.g}, ${t.fill.b}, ${Math.round(t.fill.a/255*100)/100})`:t.fill.toHex();else if("LinearGradientFill"==s){let s=t.fill.endX-t.fill.startX,r=t.fill.endY-t.fill.startY,n=Math.atan(r/s),a=180/Math.PI*n;a+=90;let o="";t.fill.colorStops.forEach(t=>{o+=`, ${t.color.toHex()} ${100*t.stop}%`}),e=`linear-gradient(${a}deg${o})`}return{type:s,value:e}}static getStroke(t){if(!t.strokeEnabled||!t.stroke)return!1;return{type:t.stroke.constructor.name,value:t.stroke.a<255?`rgba(${t.stroke.r}, ${t.stroke.g}, ${t.stroke.b}, ${Math.round(t.stroke.a/255*100)/100})`:t.stroke.toHex()}}static applyOpacity(t,e){e.opacity<1&&(t.styles.opacity=e.opacity)}}const J=s(1);s(2).storage.localFileSystem;var q={WebGraphCreator:class{constructor(t){t=t||{},this.nodes=[],this.elementIndex=t.startIndex||1,this.warnings=[]}add(t){this.nodes.push(t)}async create(){u&&console.log(g,"create()");try{const t={children:[]};for(let e=0;e<this.nodes.length;e++){let s=this.nodes[e];const r=await XDC.abstractScenegraph.get(s);this._generateEntry(r.root,t)}return t.lastAutoIdIndex=this.elementIndex,t.findById=function(t){let e=null,s=r=>{try{r.forEach(r=>{r.id==t?e=r:s(r.children)})}catch(t){console.log(g,"create()","findById()",t)}};return s(this.children),e},t}catch(t){console.log(g,"create()",t)}}_generateEntry(t,e){let s=new y(t,this.elementIndex++);this.warnings=this.warnings.concat(s.warnings),s.isSupported?(e.children.push(s),t.isMask||"BooleanGroup"==t.type||s.ignoreChildren||t.children.forEach(t=>{this._generateEntry(t,s)})):(console.log("\n\nWARNING:"),console.log(g,"Not supported element type found: ",s.node.constructor.name,"\n\n"))}},WebGraphCreatorNext:class{constructor(t){t=t||{},this.nodes=[],this.elementIndex=t.startIndex||1,this.warnings=[]}add(t){this.nodes.push(t)}async create(){T&&console.log(I,"create()");try{const t={children:[]};for(let e=0;e<this.nodes.length;e++){let s=this.nodes[e];const r=await XDC.abstractScenegraph.get(s);this._generateEntry(r.root,t)}return t.lastAutoIdIndex=this.elementIndex,t.findById=function(t){let e=null,s=r=>{try{r.forEach(r=>{r.id==t?e=r:s(r.children)})}catch(t){console.log(I,"create()","findById()",t)}};return s(this.children),e},t}catch(t){console.log(I,"create()",t)}}_generateEntry(t,e){let s=new P(t,this.elementIndex++);this.warnings=this.warnings.concat(s.warnings),s.isSupported?(e.children.push(s),t.isMask||"BooleanGroup"==t.type||s.ignoreChildren||t.children.forEach(t=>{this._generateEntry(t,s)})):(console.log("\n\nWARNING:"),console.log(I,"Not supported element type found: ",s.node.constructor.name,"\n\n"))}},WebRenderer:class{constructor(){}async render(t){try{let e={html:"",css:""};return t.children.forEach(t=>{this._process(t,e)}),e}catch(t){console.log("[ WebExport:WebRenderer ]","render()",t)}}_process(t,e){t.applyAttributes(),e.html+=`\n${t.tagOpen}`,e.html+=t.inner,e.css+=`#${t.id} {\n`;for(let s in t.styles)t.styles.hasOwnProperty(s)&&(e.css+=`  ${s}: ${t.styles[s]};\n`);e.css+="}\n",t.children.forEach(t=>{this._process(t,e)}),e.html+=`\n${t.tagClose}`}},RenditionExporter:class{constructor(t){this.outputFolder=t,this.renditionList=[]}async export(t){try{for(var e=0;e<t.children.length;e++){let s=t.children[e];await this._process(s)}if(this.renditionList.length){try{await this.tweak()}catch(t){console.log("[ RenditionExporter ]","tweak() failed (probably edit session related)")}await J.createRenditions(this.renditionList);try{await this.untweak()}catch(t){console.log("[ RenditionExporter ]","untweak() failed (probably edit session related)")}}}catch(t){console.log("[ RenditionExporter ]",t)}}async _process(t,e){try{if(t.renditions)for(var s=0;s<t.renditions.length;s++){let e=t.renditions[s],r=await this._createRenditionDefinition(e);this.renditionList.push(r)}for(let s=0;s<t.children.length;s++){let r=t.children[s];await this._process(r,e)}}catch(t){console.log("[ RenditionExporter ]",t)}}async _createRenditionDefinition(t){try{const e=await this.outputFolder.createFile(t.id+"."+t.type,{overwrite:!0}),s=t.scale||2,r="svg"==t.type?J.RenditionType.SVG:"jpg"==t.type?J.RenditionType.JPG:J.RenditionType.PNG;return{node:t.node,outputFile:e,type:r,minify:!0,embedImages:!0,scale:s,quality:70}}catch(t){console.log("[ RenditionExporter ]",t)}}async tweak(){this.renditionList.forEach(async t=>{try{if(t.node.rotation){let e=0,s=function(t){e+=t.rotation,t.parent&&"RootNode"!=t.parent.constructor.name&&s(t.parent)};s(t.node),t.__finalRotation=e,t.node.rotateAround(-e,t.node.localCenterPoint)}t.__opacity=null,t.node.opacity<1&&(t.__opacity=t.node.opacity,t.node.opacity=1),t.__shadow=null,t.node.shadow&&(t.__shadow=t.node.shadow,t.node.shadow=null),t.__blur=null,t.node.blur&&(t.__blur=t.node.blur,t.node.blur=null)}catch(t){console.log("[ RenditionExporter ]",t)}})}async untweak(){try{this.renditionList.forEach(async t=>{null!=t.__finalRotation&&0!=t.__finalRotation&&t.node.rotateAround(t.__finalRotation,t.node.localCenterPoint),null!=t.__opacity&&(t.node.opacity=t.__opacity),null!=t.__shadow&&(t.node.shadow=t.__shadow),null!=t.__blur&&(t.node.blur=t.__blur)})}catch(t){console.log(v,t)}}}};class Z{constructor(t,e){this.entry=t,this.type=t.type,this.node=t.node,this.expressions=t.expressions,this.classes=t.classes||[],this.index=e,this.id,this.tag,this.xdid=t.node.guid,this.closingTag,this.inner="",this.styles={},this.attributes={},this.children=[],this.renditions,this.process(t)}process(t){let e=/#([a-zA-Z]?[a-zA-Z0-9-_]*)/.exec(this.node.name);this.id=e?e[1]:"e"+this.index;const s=[V,K,Q,tt,et,st,rt,nt,at];for(var r=0;r<s.length;r++){let t=s[r];if(t.check(this,this.node)){t.apply(this,this.node);break}}}}class V{static check(t,e){return-1!=["Artboard"].indexOf(t.type)}static apply(t,e){t.tagOpen=`\n      <rect ${ot.getDefaultAttributes(t)}\n            ${ot.getAttributes(t)}\n            width="${ot.num(e.width)}" height="${ot.num(e.height)}"/>`,t.tagClose="",t.styles.fill=e.fillEnabled&&"Color"==ot.getFill(e).type?ot.getFill(e).value:"transparent"}}class K{static check(t,e){return"Group"==t.type&&e.mask}static apply(t,e){et.apply(t,e),t.styles.width=`${e.boundsInParent.width}px`,t.styles.height=`${e.boundsInParent.height}px`}}class Q{static check(t,e){return"Group"==t.type}static apply(t,e){const s=e.transform;t.attributes.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`,t.tagOpen=`\n      <g ${ot.getDefaultAttributes(t)}\n            ${ot.getAttributes(t)}>`,t.tagClose="</g>"}}class tt{static check(t,e){return"Text"==t.type}static apply(t,e){let s="";e.text.split(/\n/g).forEach((t,r)=>{let n=e.lineSpacing?e.lineSpacing:1.2*e.fontSize;s+=`<tspan x="0" dy="${r?n:0}px">${t}</tspan>`}),t.tagOpen=`<svg ${ot.getDefaultAttributes(t)} xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">`,t.tagClose="</svg>",t.inner=`<text x="0" y="0" style="font-family: ${e.fontFamily}; font-size: ${e.fontSize}px; fill: ${ot.getFill(e).value}">\n    ${s}</text>`,t.styles.overflow="visible",ot.applyTransformation(t,e),ot.applyOpacity(t,e)}}class et{static check(t,e){const s=ot.getFill(e);if(s&&-1!=["ImageFill"].indexOf(s.type))return!0}static apply(t,e){t.tag="img",t.tagOpen=`<img ${ot.getDefaultAttributes(t)} src="${t.id}.png">`,t.tagClose="",t.renditions=[],t.renditions.push({id:t.id,element:t,node:e}),t.attributes.src=`${t.id}.png`,ot.applySize(t,e),ot.applyTransformation(t,e),ot.applyOpacity(t,e)}}class st{static check(t,e){return-1!=["Line"].indexOf(t.type)}static apply(t,e){t.attributes.x1=ot.num(e.start.x),t.attributes.y1=ot.num(e.start.y),t.attributes.x2=ot.num(e.end.x),t.attributes.y2=ot.num(e.end.y);const s=e.transform;t.attributes.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`,t.tagOpen=`\n      <line ${ot.getDefaultAttributes(t)}\n            ${ot.getAttributes(t)} />`,t.tagClose="",ot.applyOpacity(t,e),t.styles.stroke=`${ot.getStroke(e).value}`,t.styles["stroke-width"]=`${e.strokeWidth}px`}}class rt{static check(t,e){if(-1==["Rectangle"].indexOf(t.type))return!1;const s=ot.getFill(e).type;return-1!=[void 0,"Color","LinearGradientFill","RadialGradientFill"].indexOf(s)}static apply(t,e){const s=e.transform;t.attributes.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`,e.hasRoundedCorners&&(t.attributes.rx=e.cornerRadii.topLeft,t.attributes.ry=e.cornerRadii.topLeft),t.tagOpen=`\n      <rect ${ot.getDefaultAttributes(t)}\n            ${ot.getAttributes(t)}\n            width="${ot.num(e.width)}" height="${ot.num(e.height)}"/>`,t.tagClose="",ot.applyOpacity(t,e),t.styles.fill=e.fillEnabled&&"Color"==ot.getFill(e).type?ot.getFill(e).value:"transparent",t.styles.stroke=`${ot.getStroke(e).value}`,t.styles["stroke-width"]=`${e.strokeWidth}px`}}class nt{static check(t,e){return-1!=["Ellipse"].indexOf(t.type)}static apply(t,e){t.attributes.rx=e.radiusX,t.attributes.ry=e.radiusY,t.attributes.cx=ot.num(e.radiusX),t.attributes.cy=ot.num(e.radiusY);const s=e.transform;t.attributes.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`,e.hasRoundedCorners&&(t.attributes.rx=e.cornerRadii.topLeft,t.attributes.ry=e.cornerRadii.topLeft),t.tagOpen=`\n      <ellipse ${ot.getDefaultAttributes(t)}\n               ${ot.getAttributes(t)} />`,t.tagClose="",ot.applyOpacity(t,e),t.styles.fill=e.fillEnabled&&"Color"==ot.getFill(e).type?ot.getFill(e).value:"transparent",t.styles.stroke=`${ot.getStroke(e).value}`,t.styles["stroke-width"]=`${e.strokeWidth}px`}}class at{static check(t,e){return-1!=["Path"].indexOf(t.type)}static apply(t,e){t.attributes.y=ot.num(e.translation.y),t.attributes.x=ot.num(e.translation.x);const s=e.transform;t.attributes.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`,e.hasRoundedCorners&&(t.attributes.rx=e.cornerRadii.topLeft,t.attributes.ry=e.cornerRadii.topLeft),t.tagOpen=`\n      <path ${ot.getDefaultAttributes(t)}\n               ${ot.getAttributes(t)}\n               d="${e.pathData}" />`,t.tagClose="",ot.applyOpacity(t,e),t.styles.fill=e.fillEnabled&&"Color"==ot.getFill(e).type?ot.getFill(e).value:"transparent",t.styles.stroke=`${ot.getStroke(e).value}`,t.styles["stroke-width"]=`${e.strokeWidth}px`}}class ot{static num(t,e=2){const s=Math.pow(10,e);return Math.round(t*s)/s}static getDefaultAttributes(t){let e=t.classes?`class="${t.classes.map(t=>t.replace(".","")).join(" ")}"`:"";return`id="${t.id}" ${e}`}static getAttributes(t){let e="";for(let s in t.attributes)e+=` ${s}="${t.attributes[s]}"`;return e}static applySize(t,e){e.width&&(t.styles.width=ot.num(e.width)+"px"),e.height&&(t.styles.height=ot.num(e.height)+"px")}static applyTransformation(t,e){if(0==e.rotation&&"Path"!=t.type&&"Group"!=t.type)"Ellipse"==t.type?(t.styles.cy=ot.num(e.translation.y)+ot.num(e.radiusY)+"px",t.styles.cx=ot.num(e.translation.x)+ot.num(e.radiusX)+"px"):(t.styles.y=ot.num(e.translation.y)+"px",t.styles.x=ot.num(e.translation.x)+"px");else{const s=e.transform;t.styles["transform-origin"]="0 0",t.styles.transform=`matrix(${s.a}, ${s.b}, ${s.c}, ${s.d}, ${s.e}, ${s.f})`}}static getFill(t){if(!t.fillEnabled||!t.fill)return!1;let e,s=t.fill.constructor.name;return"Color"==s&&(e=t.fill.a<255?`rgba(${t.fill.r}, ${t.fill.g}, ${t.fill.b}, ${Math.round(t.fill.a/255*100)/100})`:t.fill.toHex()),{type:s,value:e}}static getStroke(t){if(!t.strokeEnabled||!t.stroke)return!1;return{type:t.stroke.constructor.name,value:t.stroke.a<255?`rgba(${t.stroke.r}, ${t.stroke.g}, ${t.stroke.b}, ${Math.round(t.stroke.a/255*100)/100})`:t.stroke.toHex()}}static applyOpacity(t,e){e.opacity<1&&(t.styles.opacity=e.opacity)}}const it=s(1),lt=s(2).storage.localFileSystem;var ct={SvgGraphCreator:class{constructor(){this.nodes=[],this.elementIndex=1}add(t){this.nodes.push(t)}async create(){try{let t={children:[]};for(let e=0;e<this.nodes.length;e++){let s=this.nodes[e];const r=await XDC.abstractScenegraph.get(s);this._generateEntry(r.root,t)}return t}catch(t){console.log("[ SvgExport:SvgGraphCreator ]",t)}}_generateEntry(t,e){let s=new Z(t,this.elementIndex++);e.children.push(s),t.isMask||t.children.forEach(t=>{this._generateEntry(t,s)})}},SvgRenderer:class{constructor(){}async render(t){try{let e={svg:"",css:""};return t.children.forEach(t=>{this._process(t,e)}),e}catch(t){console.log("[ SvgExport:SvgRenderer ]",t)}}_process(t,e){e.svg+=`\n${t.tagOpen}`,e.svg+=t.inner,e.css+=`#${t.id} {\n`;for(let s in t.styles)t.styles.hasOwnProperty(s)&&(e.css+=`  ${s}: ${t.styles[s]};\n`);e.css+="}\n",t.children.forEach(t=>{this._process(t,e)}),e.svg+=`\n${t.tagClose}`}},RenditionExporter:class{constructor(){this.renditionList=[]}async export(t){try{for(var e=0;e<t.children.length;e++){let s=t.children[e];await this._process(s)}this.renditionList.length&&(await this.tweak(),await it.createRenditions(this.renditionList),await this.untweak())}catch(t){console.log("[ RenditionExporter ]",t)}}async _process(t,e){try{if(t.renditions)for(var s=0;s<t.renditions.length;s++){let e=t.renditions[s],r=await this._createRenditionDefinition(e);this.renditionList.push(r)}for(let s=0;s<t.children.length;s++){let r=t.children[s];await this._process(r,e)}}catch(t){console.log("[ RenditionExporter ]",t)}}async _createRenditionDefinition(t){try{const e=await lt.getDataFolder(),s=await e.createFile(t.id+".png",{overwrite:!0});return{node:t.node,outputFile:s,type:it.RenditionType.PNG,minify:!0,embedImages:!0,scale:2,quality:70}}catch(t){console.log("[ RenditionExporter ]",t)}}async tweak(){try{this.renditionList.forEach(async t=>{let e=0,s=function(t){e+=t.rotation,t.parent&&"RootNode"!=t.parent.constructor.name&&s(t.parent)};s(t.node),t.__finalRotation=e,t.node.rotation&&t.node.rotateAround(-e,t.node.localCenterPoint)})}catch(t){console.log("[ RenditionExporter ]",t)}}async untweak(){try{this.renditionList.forEach(async t=>{if(null!=t.__finalRotation&&0!=t.__finalRotation)try{t.node.rotateAround(t.__finalRotation,t.node.localCenterPoint)}catch(t){console.log("[ RenditionExporter ]",t)}})}catch(t){console.log("[ RenditionExporter ]",t)}}}};s(0);const{selection:dt,root:pt}=s(0);class ht{static parseNodeName(t){return this.parse(t)}static parse(t){let e=new ut;let s=t.name.match(/@[a-zA-Z]{1}[a-zA-Z\.]*({.*?})?/g);return s&&s.forEach(s=>{let[r,n]=s.split("@");const a=new gt(t,n="@"+n);e.add(a)}),e}}class ut{constructor(){this.expressions=[]}add(t){this.expressions.push(t)}get(t){return t?this.expressions.filter(e=>e.command==t)[0]:this.expressions}}class gt{constructor(t,e){this.node=t,this.expressionString=e,this.arguments=[];let[s,r,n]=/@([a-zA-Z]{1}[a-zA-Z\.]*)({.*?})?/.exec(e);this.command=r;if(n){let t=(n=n.trim().replace("{","").replace("}","")).split(",");for(let e=0,s=t.length;e<s;e++){let s=t[e].split(":"),r="string"==typeof s[1]?s[1].trim():void 0,n="true"==r||"false"!=r&&(!Number.isNaN(Number(r))&&Number.parseFloat(r)?Number.parseFloat(r):r);if(s[0]&&null!=n){let t={key:s[0].trim(),value:n};this.arguments.push(t)}}}}get(t){for(let e=0,s=this.arguments.length;e<s;e++){let s=this.arguments[e];if(s.key==t)return s.value}}set(t,e){for(let s=0,r=this.arguments.length;s<r;s++){let r=this.arguments[s];if(r.key==t)return r.value=e,void this.persist()}this.arguments.push({key:t,value:e}),this.persist()}toExpressionString(){let t=`@${this.command}`;return this.arguments.length&&(t+="{",this.arguments.forEach(e=>{null!=e.value&&(t+=`${e.key}: ${e.value}, `)}),t=t.substr(0,t.length-2),t+="}"),t}persist(){this.node.name=this.node.name.replace(this.expressionString,this.toExpressionString())}}class yt{static async processNode(t,e){try{e.type=t.constructor.name,e.name=t.name,e.node=t,e.expressions=XDC.expressions.getExpressionsByNode(t),e.classes=yt.getClasses(t.name);for(let s=0;s<t.children.length;s++){const r=t.children.at(s),n=new ft;n.isMask=!!r.mask,e.children.push(n),await this.processNode(r,n)}}catch(t){console.log(log,t)}}static getClasses(t){return t.match(/(^|\W)\.[\w-]+/g)}}class ft{constructor(){this.node,this.expressions,this.isMask=!1,this.children=[]}}const mt=s(0),xt=s(1),bt=s(3),$t=s(4),kt=s(5);e.default={scenegraph:mt,root:mt.root,selection:mt.selection,commands:$t,application:xt,viewport:bt,assets:kt,XdTpl:class{constructor(){this.version="2.0"}place(t,e){return new Promise((s,r)=>{try{e=e||{},d.getPluginFolder().then(r=>{r.getEntry(t).then(t=>{t.read().then(t=>{e.offsetX=e.offsetX?e.offsetX:0,e.offsetY=e.offsetY?e.offsetY:0;const r=JSON.parse(t);let i,l=n.editContext;i=l==a?XDC.core.getBounds():XDC.core.getBounds([n.items[0]]);const d=this.import(l,r)[0];if(d.name=e.rename?e.rename:d.name,"rightTop"==e.position)d.placeInParentCoordinates({x:d.localBounds.x,y:d.localBounds.y},{x:i.right+100,y:i.top});else{const t=XDC.viewport.bounds,e={x:t.x+t.width/2-d.localBounds.width/2,y:t.y+t.height/2-d.localBounds.height/2};d.placeInParentCoordinates({x:d.localBounds.x,y:d.localBounds.y},e)}!0===e.ungroup?o.ungroup():n.items=d,c.scrollIntoView(n.items[0]),s({node:d})})})})}catch(t){console.log("Error during XDTPL place()",t)}})}async export(t){const e={type:"XDTPL",version:this.version,sets:[]};for(let s=0;s<t.length;s++){let r=t[s];const n={name:`set_${s}`,type:"Set",children:[]};n.children.push(await this._exportNode(r)),e.sets.push(n)}return JSON.stringify(e,null,0)}async _exportNode(t){const e={type:t.constructor.name};if([{property:"name"},{property:"width"},{property:"height"},{property:"text"},{property:"areaBox"},{property:"textAlign"},{property:"lineSpacing"},{property:"radiusX"},{property:"radiusY"},{property:"translation"}].forEach(s=>{null!=t[s.property]&&(e[s.property]=t[s.property])}),t.styleRanges&&t.styleRanges.length&&(e.styleRanges=[],t.styleRanges.forEach(t=>{e.styleRanges.push({length:t.length,fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontSize:t.fontSize,fill:t.fill.toHex()})})),t.cornerRadii&&(e.cornerRadii={topLeft:t.cornerRadii.topLeft,topRight:t.cornerRadii.topRight,bottomRight:t.cornerRadii.bottomRight,bottomLeft:t.cornerRadii.bottomLeft}),0!=t.rotation&&(e.rotation=t.rotation,e.rotationPoint=t.localCenterPoint),t.opacity<1&&(e.opacity=t.opacity),t.mask&&(e.mask=!0),t.fillEnabled&&(e.fillEnabled=t.fillEnabled,t.fill))switch(e.fill={type:t.fill.constructor.name},t.fill.constructor.name){case"Color":e.fill.hex=t.fill.toHex(),e.fill.alpha=Math.round(t.fill.a/255*100)/100;break;case"LinearGradientFill":e.fill.startX=t.fill.startX,e.fill.startY=t.fill.startY,e.fill.endX=t.fill.endX,e.fill.endY=t.fill.endY,e.fill.colorStops=[],t.fill.colorStops.forEach(t=>{e.fill.colorStops.push({color:t.color.toHex(),alpha:t.color.a/255,stop:t.stop})});break;case"ImageFill":try{let s=t.fill.naturalWidth/t.width;s=s>6?6:s;const r=await d.getTemporaryFolder(),n=await r.createEntry("xdtpl_export_image.tmp",{overwrite:!0});await new Promise((r,a)=>{let o=[{node:t,outputFile:n,type:"image/jpeg"==t.fill.mimeType?i.RenditionType.JPG:i.RenditionType.PNG,scale:s,quality:70}];i.createRenditions(o).then(async t=>{const s=await n.read({format:l.formats.binary});e.fill.base64=XDC.misc.arrayBufferToBase64(s),r()}).catch(t=>{console.log("[ XDTPL Error ] Error during creation of temp image to extract base64",t),a()})})}catch(t){console.log("[ XDTPL ] Error in _exportNode(): ",t)}}if(t.strokeEnabled&&t.stroke&&(e.strokeEnabled=t.strokeEnabled,e.stroke=t.stroke.toHex(),e.strokeWidth=t.strokeWidth,e.strokePosition=t.strokePosition,e.strokeEndCaps=t.strokeEndCaps,e.strokeJoins=t.strokeJoins,e.strokeMiterLimit=t.strokeMiterLimit,e.strokeDashOffset=t.strokeDashOffset,t.strokeDashArray.length&&(e.strokeDashArray=[],t.strokeDashArray.forEach(t=>e.strokeDashArray.push(t)))),t.blur&&(e.blur={blurAmount:t.blur.blurAmount,brightnessAmount:t.blur.brightnessAmount,fillOpacity:t.blur.fillOpacity,isBackgroundEffect:t.blur.isBackgroundEffect,visible:t.blur.visible}),t.shadow){let s={hex:t.shadow.color.toHex(),alpha:Math.round(t.shadow.color.a/255*100)/100};e.shadow={x:t.shadow.x,y:t.shadow.y,blur:t.shadow.blur,color:s,visible:t.shadow.visible}}if("Line"==t.constructor.name&&(e.startX=t.start.x,e.startY=t.start.y,e.endX=t.end.x,e.endY=t.end.y),"Path"==t.constructor.name&&(e.pathData=t.pathData),e.sharedPluginData=JSON.stringify(t.sharedPluginData.getAll()),t.children&&t.children.length){e.children=[];for(var s=0;s<t.children.length;s++){const r=t.children.at(s);e.children.push(await this._exportNode(r))}}return e}import(t,e){try{const s=[];return e.sets.forEach((e,r)=>{e.children.forEach((e,r)=>{s.push(this._createNode(e,t,[]))})}),s}catch(t){console.log("XdTpl import Error:",t)}}_createNode(t,e,s){try{let a;if(["Group","SymbolInstance","BooleanGroup","RepeatGrid"].indexOf(t.type)>=0&&(s=[]),"Group"!=t.type&&"RepeatGrid"!=t.type&&"SymbolInstance"!=t.type&&"BooleanGroup"!=t.type&&((a=new r[t.type]).name=t.name,this._addTypeSpecificProperties(a,t),t.rotation&&a.rotateAround(t.rotation,t.rotationPoint),a.translation=t.translation,"Artboard"==t.type?(XDC.core.addArtboard(a),e=a):e.addChild(a),a&&s.push(a)),t.children&&t.children.length&&t.children.forEach(t=>{let r=this._createNode(t,e,s);r&&["Group","SymbolInstance","BooleanGroup","RepeatGrid"].indexOf(r.constructor.name)>=0&&s.push(r)}),["Group","SymbolInstance","BooleanGroup","RepeatGrid"].indexOf(t.type)>=0&&s.length){n.items=s,t.mask,o[t.mask?"createMaskGroup":"group"]();let e=n.items[0];e.name=t.name,e.translation=t.translation,t.opacity&&(e.opacity=parseFloat(t.opacity)),t.rotation&&(e.rotateAround(t.rotation,t.rotationPoint),e.placeInParentCoordinates({x:0,y:0},{x:t.translation.x,y:t.translation.y})),a=e}if(t.sharedPluginData&&Object.keys(t.sharedPluginData).length){let e=JSON.parse(t.sharedPluginData);for(const t in e)if(t===XDC.pluginId){const s=e[t];for(const t in s)XDC.core.setData(a,t,s[t],{withoutEditSession:!0})}}return a}catch(t){console.error("Error in XDTPL._createNode():",t.message)}}_addTypeSpecificProperties(t,e){switch(e.type){case"Artboard":case"Rectangle":t.width=e.width,t.height=e.height}switch(e.type){case"Artboard":this._addFillAndStroke(t,e);break;case"Line":case"Rectangle":case"Ellipse":case"Path":t.opacity=null!=e.opacity?e.opacity:1,this._addFillAndStroke(t,e);break;case"Text":t.opacity=null!=e.opacity?e.opacity:1}switch(this._addBlur(t,e),this._addShadow(t,e),e.type){case"Line":t.setStartEnd(e.startX,e.startY,e.endX,e.endY);break;case"Rectangle":e.cornerRadii&&(t.cornerRadii=e.cornerRadii);break;case"Ellipse":t.radiusX=e.radiusX,t.radiusY=e.radiusY;break;case"Path":t.pathData=e.pathData;break;case"Text":t.text=e.text,t.areaBox=e.areaBox;let s=JSON.parse(JSON.stringify(e.styleRanges));s.forEach(t=>{t.fill=new r.Color(t.fill)}),t.styleRanges=s,t.textAlign=e.textAlign,t.lineSpacing=e.lineSpacing}}_addFillAndStroke(t,e){switch("Artboard"!=e.type&&"Line"!=e.type&&(t.fillEnabled=e.fillEnabled||!1),e.fill?e.fill.type:null){case"Color":t.fill=new r.Color(e.fill.hex,e.fill.alpha);break;case"LinearGradientFill":const s=new r.LinearGradient;s.setEndPoints(e.fill.startX,e.fill.startY,e.fill.endX,e.fill.endY);const n=[];e.fill.colorStops.forEach(t=>{n.push({color:new r.Color(t.color,t.color.alpha),stop:t.stop})}),s.colorStops=n,t.fill=s;break;case"ImageFill":const a=new r.ImageFill(`data:image/jpeg;base64,${e.fill.base64}`);t.fill=a}"Artboard"!=e.type&&(t.strokeEnabled=e.strokeEnabled||!1),e.strokeEnabled&&(t.stroke=new r.Color(e.stroke),t.strokeWidth=e.strokeWidth,t.strokePosition=e.strokePosition,e.strokeEndCaps&&(t.strokeEndCaps=e.strokeEndCaps),e.strokeJoins&&(t.strokeJoins=e.strokeJoins),e.strokeMiterLimit&&(t.strokeMiterLimit=e.strokeMiterLimit),e.strokeDashOffset&&(t.strokeDashOffset=e.strokeDashOffset),e.strokeDashArray&&(t.strokeDashArray=e.strokeDashArray))}_addBlur(t,e){e.blur&&(t.blur=new r.Blur(e.blur.blurAmount,e.blur.brightnessAmount,e.blur.fillOpacity,e.blur.visible,e.blur.isBackgroundEffect))}_addShadow(t,e){if(!e.shadow)return;let s=new r.Color(e.shadow.color.hex,e.shadow.color.alpha);t.shadow=new r.Shadow(e.shadow.x,e.shadow.y,e.shadow.blur,s,e.shadow.visible)}},XdCss:class{constructor(t){this.debug=!1,this.styleGraph,this.classGraph,this.affectedElements}async parse(t){return new Promise((e,s)=>{let r={};p.colors.get().forEach(t=>{r[t.name]=t.color.toHex()}),less.render(t,{plugins:[h],globalVars:r}).then(t=>{let r=t.css.replace(/\/\*([\s\S]*?)\*\//g,"");try{let t=[];r.split("}").forEach(e=>{let s=e.split("{");if(0===s[0].trim().length||0===s[1].trim().length)return;let r={selectors:[],properties:{}};t.push(r);let n=s[0].split(",");for(var a=0;a<n.length;a++){let t=[];n[a].trim().split(" ").forEach(e=>{let s=e.split(".").map(t=>t="."+t);s.shift(),t.push(s)}),r.selectors.push(t)}let o=s[1].split(";");for(a=0;a<o.length-1;a++){let t=o[a].split(":"),e=t[0].replace(/\n/g,"").trim();r.properties[e]=t[1].replace(/\n/g,"").trim()}}),e(t),this.styleGraph=t}catch(t){console.log("Error while parsing CSS",t),s(t)}},function(t){console.log("Error while parsing CSS",t),s(t)})})}generateClassGraph(t){try{function e(t){return t.name.match(/(\.[a-zA-Z0-9-_]+)/g)}let s=function(t,r,n){let a=e(t);if(a){n.push(a);let e=[];n.forEach(t=>e.push(t)),e.pop();let s={type:t.constructor.name,classes:a,path:e,node:t};r.children=r.children?r.children:[],r.children.push(s),r=s}return t.children&&t.children.length&&t.children.forEach(t=>{-1==["SymbolInstance","RepeatGrid","BooleanGroup"].indexOf(t.constructor.name)&&s(t,r,n)}),a&&n.pop(),r},r=[];return t.parent&&function t(s){let n=e(s.parent);n&&r.unshift(n),s.parent&&"RootNode"!=s.parent.constructor.name&&t(s.parent)}(t),this.classGraph=s(t,{children:[]},r),this.classGraph}catch(t){console.log("Error in XdCss.queryNodesWithClasses():",t)}}logClassGraphOutline(t){!function t(e,s){e.children.forEach(e=>{let r="";for(var n=0;n<s;n++)r+="   ";console.log(r,e.node.name,`(${e.type})`,e.path),e.children&&(t(e,++s),s--)})}(this.generateClassGraph(t),0)}async render(t,e){const s=(new Date).getTime();let r=await this.parse(e);console.log("parse:             ",(new Date).getTime()-s,"ms");const n=(new Date).getTime();let a=this.generateClassGraph(t);console.log("classGraph:        ",(new Date).getTime()-n,"ms");let o=0,i=(t,e)=>{t.children.forEach(t=>{let s="";for(var n=0;n<e;n++)s+="   ";this.debug&&console.log(s,t.node.name,`(${t.type})`,t.classes,"path:",t.path),o++,this._renderClassGraphNode(t,r),t.children&&(i(t,++e),e--)})};i(a,0),this.affectedElements=o}_renderClassGraphNode(t,e){const s="                                 ";if(e.forEach(e=>{for(let a=0,o=e.selectors.length;a<o;a++){let o=e.selectors[a];this.debug&&console.log("                              (?) selector:",o);let i=this;function r(t,e){let r=t[t.length-1],n=!0,a=!1;for(let t=0,s=r.length;t<s;t++){let s=r[t];if(-1==e.classes.indexOf(s))return n=!1,!1}if(i.debug&&console.log(s,"classMatches:",n),n){if(0===e.path.length&&t.length>1)return!1;if(0===e.path.length&&1===t.length)return!0;if(1===t.length)return!0}let o=Array.from(e.path),l=(e,r)=>{let n=t[e];i.debug&&console.log(s,"next test: currentSelectorSegment:",n);let c=o.findIndex(t=>{i.debug&&console.log(s," *?# SEARCH:",n,"  IN ",t);for(let e=0,s=n.length;e<s;e++)if(-1===t.indexOf(n[e]))return!1;return!0});i.debug&&console.log(s," + pathIndex",c),i.debug&&console.log(s," + lastPathIndex",r);const d=o.splice(0,c+1).length;c<r||-1!=c&&(++e<t.length-1?l(e,c-d):a=!0)};return l(0,-999),i.debug&&console.log(s,"check: pathMatches:",a),n&&a}let l=r(o,t);if(this.debug&&console.log(s,l?"✅ ":"✖",e.selectors),l)for(var n in t.cache=t.cache?t.cache:{},e.properties)t.cache[n]=e.properties[n]}}),t.cache)for(var r in t.cache){const e=t.node,s=t.cache[r];switch(r){case"background-color":case"fill":const t=p.colors.get().filter(t=>t.name==s);t&&t.length>0&&t[0].color?e.fill=t[0].color:e.fill=new XDC.scenegraph.Color(s);break;case"stroke":case"stroke-color":e.stroke=new XDC.scenegraph.Color(s),e.strokeEnabled=!0;break;case"stroke-width":e.strokeWidth=Number(s),e.strokeEnabled=!0;break;case"corner-radius":-1!=["Rectangle"].indexOf(e.constructor.name)&&e.setAllCornerRadii(Number(s));break;case"font-family":-1!=["Text"].indexOf(e.constructor.name)&&(e.fontFamily=s);break;case"font-size":-1!=["Text"].indexOf(e.constructor.name)&&(e.fontSize=Number(s));break;case"font-style":-1!=["Text"].indexOf(e.constructor.name)&&(e.fontStyle=s)}}}},webExport:q,svgExport:ct,core:class{static getAllArtboards(){return pt.children.filter(t=>"Artboard"==t.constructor.name)}static getLastArtboard(){return this.getAllArtboards().pop()}static addArtboard(t){let e=this.getLastArtboard();e?pt.addChildAfter(t,e):pt.children.at(0)?pt.addChildBefore(t,pt.children.at(0)):pt.addChild(t)}static getBounds(t,e){t=t||pt.children,e="global"!=e&&"local"!=e?"parent":e;let s={left:null,top:null,right:null,bottom:null,width:null,height:null};return t.forEach(t=>{const r="global"==e?t.globalBounds:"parent"==e?t.boundsInParent:t.localBounds;(null==s.left||r.x<s.left)&&(s.left=r.x),(null==s.top||r.y<s.top)&&(s.top=r.y),(null==s.right||r.x+r.width>s.right)&&(s.right=r.x+r.width),(null==s.bottom||r.y+r.height>s.bottom)&&(s.bottom=r.y+r.height)}),s.width=s.right-s.left,s.height=s.bottom-s.top,s}static getChildIndex(t){for(let e=0;e<t.parent.children.length;e++)if(t.parent.children.at(e)==t)return e}static getChildByIndex(t,e){return t.children.at(e)}static closestMasterComponent(t){for(;t.parent;){if("SymbolInstance"==t.constructor.name&&t.isMaster)return t;t=t.parent}return!1}static getNodeByGuid(t,e){let s;e=e||XDC.root;let r=e=>{if(e.guid!=t)for(let t=0;t<e.children.length&&(r(e.children.at(t)),!s);t++);else s=e};return r(e),s}static getId(t){let e=/#([a-zA-Z]?[a-zA-Z0-9-_]*)/.exec(t.name);return e?e[1]:"guid_"+t.guid.replace(/-/g,"_")}static setData(t,e,s,r){r&&r.withoutEditSession?(s="string"!=typeof s?JSON.stringify(s):s,t.sharedPluginData.setItem(XDC.pluginId,e,s)):XDC.application.editDocument(r=>{s="string"!=typeof s?JSON.stringify(s):s,t.sharedPluginData.setItem(XDC.pluginId,e,s)})}static getData(t,e,s){(s=s||{}).pluginId=s.pluginId?s.pluginId:XDC.pluginId;let r=t.sharedPluginData.getItem(s.pluginId,e);try{return r=r?JSON.parse(r):null}catch(s){return console.log("[ XDC:core ]","setData()","ERROR reading/parsing element data: ",t,e),null}}static checkSingleSelection(t){const e=XDC.selection.items;return 1==e.length&&(void 0===(t="string"==typeof t?[t]:t)||-1!=t.indexOf(e[0].constructor.name))}},query:class{static exec(){console.log("query::exec")}static queryByExpression(t,e){e.levels=null!=e.levels?e.levels:9999;const s=[];let r=(t,e,n)=>{let a=XDC.expressions.getExpressionsByNode(t).get(e.expression);a&&n<=e.levels+1&&s.push({node:t,expression:a,level:n}),t.children.forEach(t=>{r(t,e,++n),n--})};return"Array"==t.constructor.name||"SceneNodeList"==t.constructor.name?t.forEach(t=>{r(t,e,0)}):r(t,e,0),s}static query(t,e){const s=[];let r=(t,e)=>{let n={};for(const s in e){let r;switch(s){case"type":e[s]instanceof Array?e[s].forEach(e=>{r||(r=t.constructor.name==e)}):r=t.constructor.name==e[s];break;case"fill":t.fill&&"Color"==t.fill.constructor.name&&(r=e[s].exec(t.fill.toHex()));break;default:r=e[s].exec(t[s])}n[s]=r}if(Object.getOwnPropertyNames(n)){let e=!0;for(let t in n)n[t]||(e=!1);e&&s.push({node:t,results:n})}t.children.forEach(t=>{r(t,e)})};return"Array"==t.constructor.name||"SceneNodeList"==t.constructor.name?t.forEach(t=>{r(t,e)}):r(t,e),s}static getParentArtboard(t){if(!(t=t||XDC.selection.items[0]))return!1;for(;t.parent;){if("Artboard"==t.constructor.name)return t;t=t.parent}return!1}},expressions:class{static set(t,e,s,r){let n=ht.parse(t).get(e);n?n.set(s,r):t.name+=` @${e}{${s}: ${r}}`}static remove(t,e){let s=ht.parse(t).get(e);if(s)return t.name=t.name.replace(s.toExpressionString(),""),!0}static get(t,e,s){let r=ht.parseNodeName(t);if(!e)return r.get().length?r:void 0;let n=r.get(e);return s?n?n.get(s):void 0:n}static getExpressionsByNode(t){return ht.parseNodeName(t)}static getNodeNameWithoutExpressions(t){let e=this.get(t);if(!e)return t.name;let s=t.name;return e.expressions.forEach(t=>{s=s.replace(t.expressionString,"")}),s}static execute(){}},abstractScenegraph:class{static async get(t){return new Promise(async(e,s)=>{try{const s={type:"ASC",version:"1.0.0",root:new ft};await yt.processNode(t,s.root),e(s)}catch(t){console.log(log,t)}})}},misc:class{static arrayBufferToBase64(t){for(var e,s="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(t),a=n.byteLength,o=a%3,i=a-o,l=0;l<i;l+=3)s+=r[(16515072&(e=n[l]<<16|n[l+1]<<8|n[l+2]))>>18]+r[(258048&e)>>12]+r[(4032&e)>>6]+r[63&e];return 1==o?s+=r[(252&(e=n[i]))>>2]+r[(3&e)<<4]+"==":2==o&&(s+=r[(64512&(e=n[i]<<8|n[i+1]))>>10]+r[(1008&e)>>4]+r[(15&e)<<2]+"="),s}},geometry:class{static debugTransformOutline(t){console.log("[ XDC geometry]","debugTransformOutline()"),console.log(""),console.log("[ XDC geometry]"," OUTLINE:"),async function t(e,s){console.log(s,""),console.log(s,"node:",e.name),console.log(s,".width:",e.width,", height:",e.height),console.log(s,".transform:",e.transform),console.log(s,".transform.getRotation():",e.transform.getRotation()),console.log(s,".translation:",e.translation),console.log(s,".rotation:",e.rotation),console.log(s,".localCenterPoint:",e.localCenterPoint),console.log(s,".localBounds:",e.localBounds),console.log(s,".boundsInParent:",JSON.stringify(e.boundsInParent)),"Artboard"!=e.parent.constructor.name&&t(e.parent,s+"  ")}(t,"")}}}}]).default;